<!DOCTYPE html>
<html lang="en-us">

<head>

  <head>

    <br><br>
    <title>Send a set of command lines to GNOME Terminal</title>

    
    <style>

    html body {
        font-family: ZgotmplZ, sans-serif;
        background-color: white;
    }

    :root {
        --accent: #2196F3;
        --border-width:  0 ;
    }

</style>


<link rel="stylesheet" href="../../../css/main.css">


<link rel="stylesheet" href="../../../css/perso.css">

<link rel="stylesheet" href="../../../css/creativecommons.css">

<link rel="stylesheet" href="../../../css/flag-icon.css">


<link href="https://unpkg.com/ionicons@4.2.2/dist/css/ionicons.min.css" rel="stylesheet">

<link rel="stylesheet" href="../../../css/font-awesome.min.css">

<link rel="stylesheet" href="../../../css/academicons.min.css" />


<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Changa%20One">


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="../../../js/jquery-ui-1.9.1.custom.min.js"></script>
<script src="../../../js/jquery.tocify.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">




     










<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/highlight.min.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/languages//bash.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/languages//html.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/languages//julia.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/languages//python.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/languages//r.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/languages//rust.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/languages//xml.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/languages//yaml.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/languages//tex.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/languages//shell.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/languages//matlab.min.js"></script>


<script>
  hljs.initHighlightingOnLoad();
</script>


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/styles/tomorrow-night-eighties.min.css">






<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: false,
    }
    });
    </script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/latest.js?config=TeX-MML-AM_CHTML' async></script>





<link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin="" />
<script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js" integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og==" crossorigin=""></script>


    <meta name="generator" content="Hugo 0.53" />

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

  </head>
</head>


<body>

  <nav class="navbar navbar-default navbar-fixed-top">

    <div class="container">

      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      </div>


      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">

        
        <ul class="nav navbar-nav mr-auto">
          
          
          <li><a href="../../../publications/">Publications</a></li>
          


          
          
          <li><a href="../../../talks/">Talks&amp;Posters</a></li>
          


          
          
          <li><a href="../../../teaching/">Teaching</a></li>
          


          
          
          <li><a href="../../../software/">Software</a></li>
          


          
          
          <li><a href="../../../econotes/">EcoNotes</a></li>
          


          
          
          <li><a href="../../../notes/">SilicoNotes</a></li>
          


          
          
          <li><a href="../../../perso/">Perso</a></li>
          


          
        </ul>
        

        
        <ul class="nav navbar-nav navbar-right">
          
          <li class="navbar-icon"> <a href="../../../"><i class="fa fa-home"></i></a></li>
          
          <li class="navbar-icon"> <a href="https://insileco.github.io/"><i class="fa fa-external-link-square"></i></a></li>
          
          <li class="navbar-icon"> <a href="https://www.github.com/KevCaz"><i class="fa fa-github"></i></a></li>
          
        </ul>
        

        </ul>

      </div>

    </div>

  </nav>

  <br>



<div class="container">

  <div class="row">

    <div class="col-sm-2">
      <div class="hidden-sm hidden-xs">

        

        

      </div>
    </div>

    <div class="col-sm-10">

      

<div class="article-meta">
  <h1><span class="title">Send a set of command lines to GNOME Terminal</span></h1>
  <h3><span class="subtitle"></span></h3>
  
  <h3 class="date" style="font-size: 1.25em;">June 10, 2019</h2>

  
  
    <p class="tags">
      <i class="fa fa-tags" aria-hidden="true"></i> &nbsp;
      
        <a href="../../../tags/atom"> <kbd class="item-tag">Atom</kbd></a>
      
        <a href="../../../tags/cli"> <kbd class="item-tag">cli</kbd></a>
      
        <a href="../../../tags/gnome-terminal"> <kbd class="item-tag">gnome-terminal</kbd></a>
      
        <a href="../../../tags/window-manager"> <kbd class="item-tag">window manager</kbd></a>
      
        <a href="../../../tags/xclip"> <kbd class="item-tag">xclip</kbd></a>
      
        <a href="../../../tags/xdotool"> <kbd class="item-tag">xdotool</kbd></a>
      
        <a href="../../../tags/xsel"> <kbd class="item-tag">xsel</kbd></a>
      
    </p>
  
  

  
  
  

  <br>

</div>



<h2 id="context">Context</h2>

<p>As mentioned several times on this website, I use <a href="https://atom.io/" target="_blank">Atom</a> for
my coding as well as for writing posts and manuscripts. While coding, one often
needs to run commands in a terminal. To do so, I use specific Atom packages such
as <a href="https://atom.io/packages/ide-r" target="_blank">IDE-R</a> or <a href="https://github.com/JunoLab/atom-julia-client" target="_blank">Julia
Client</a> to run R and Julia
commands respectively and
<a href="https://github.com/platformio/platformio-atom-ide-terminal" target="_blank">platformio-ide-terminal</a>.
The latter meets most of my expectations, but:</p>

<ol>
<li><p>the terminal emulated is in a bottom panel and when I&rsquo;m working on my laptop I cannot get a good overview of the code and the corresponding outputs at the same time, pretty annoying&hellip; and having the terminal in the right panel is a <a href="https://github.com/platformio/platformio-atom-ide-terminal/issues/198" target="_blank">feature unlikely to be implemented in a near future</a>;</p></li>

<li><p>in many cases, I&rsquo;d prefer to run command lines in a terminal emulator that is
not a child process of Atom so that the commands are run independently from it.</p></li>
</ol>

<p>The solution I&rsquo;ve envisioned for a while now is to use Atom for coding and run
the commands in GNOME terminal (which I very much like, <a href="http://www.linuxandubuntu.com/home/10-best-linux-terminals-for-ubuntu-and-fedora" target="_blank">but many good
alternatives
exist</a>. Of course I have always been able to do so, but I had to copy paste every code chunk ‚¨áÔ∏è.</p>

<center>
  <video width='
    
      100%
    '
  controls>
    <source src="../../../notes/cli/assets/copypaste.webm" type="video/webm">
    Your browser does not support the video tag.
  </video>
</center>


<p>And this has always been bothering me (more than it should have) for a long time
now. So last weekend I decided to find a way to get a shortcut that would
directly send command lines to GNOME Terminal and execute it.</p>

<p>There actually is an Atom package to send command to Terminal,
<a href="https://atom.io/packages/r-exec" target="_blank">r-exec</a>, but it only works for MacOS as it
uses
<a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptX/AppleScriptX.html" target="_blank">AppleScript</a>. So, all I had to do was to do an Linux equivalent of r-exec, no less&hellip; I rolled up my sleeves and
read and code and read and code and finally came out with a solution üòÑ!</p>

<h2 id="solution">Solution</h2>

<h3 id="requirements">Requirements</h3>

<p>Before detailing the bash script I created, I must mention a couple of important point about prerequisites. First, here is my current OS and desktop environment (I&rsquo;ve used <a href="https://github.com/smxi/inxi" target="_blank">inxi</a> to share these infos):</p>

<pre><code>$ inxi -S
System:
 Host: debkev Kernel: 4.19.0-5-amd64 x86_64 bits: 64
 Desktop: Gnome 3.30.2 Distro: Debian GNU/Linux 10 (buster)
</code></pre>

<p>Second, <strong>the solution below only works if GNOME is running atop
<a href="https://www.x.org/wiki/" target="_blank">X.org</a></strong>, not on
<a href="https://wayland.freedesktop.org/" target="_blank">Walyand</a> which is <a href="https://www.phoronix.com/scan.php?page=news_item&amp;px=Debian-10-GNOME-Wayland-vs-X" target="_blank">the default on Debian
Buster</a>. In my case, the very first step was to go back to <a href="https://www.x.org/wiki/" target="_blank">X.org</a>. To do so, I commented the line <code>WaylandEnable=false</code> in <code>/etc/gdm3/daemon.conf</code> ‚¨áÔ∏è:</p>

<center>

  
  <img src="../../../notes/cli/assets/backtoXorg.png" width="65%">
  
  
</center>


<p><br></p>

<p>That being said, if you are using a UNIX distro and your terminal window is managed by X.org, it should fairly easy to adapt the approach below.</p>

<h3 id="bash-script">Bash script</h3>

<p>In order to use the script, <code>xclip</code> and <code>xdotool</code> must be installed:</p>

<pre><code># apt-get install xclip xdotool
</code></pre>

<p>The bash script I&rsquo;ve created automates 4 operations:</p>

<ol>
<li><p>it copy-pastes the current selection with <a href="https://github.com/astrand/xcli" target="_blank">xclip</a>;</p></li>

<li><p>it calls <a href="https://github.com/jordansissel/xdotool" target="_blank">xdotool</a> to identify where GNOME-Terminal windows and use the id of the last one (with <code>tail</code>);</p></li>

<li><p>it changes the focused window with <code>xdotool</code>;</p></li>

<li><p>it pastes the content of the clipboard in the Terminal and executes the command via <code>xdotool</code>.</p></li>
</ol>

<p>Here is the bash script I used:</p>

<pre><code>#!/bin/bash
# Current selection to clipboard
xclip -o -selection primary | xclip -i -selection clipboard

# pause to let me have all my keys are up
# see https://stackoverflow.com/questions/34092604
sleep .1

# Find the last gnome terminal window
w=$(xdotool search --class gnome-terminal | tail -1)

# test if a terminal is actually open, otherwise opens one
if ! [[ $w =~ [0-9]+ ]]; then
  gnome-terminal
  w=$(xdotool search --class gnome-terminal | tail -1)
fi

# focus on the right window
xdotool windowfocus $w

# paste the command (ctrl+shift+v) and execute it (Return)
xdotool key --clearmodifiers ctrl+shift+v Return
</code></pre>

<p>The final step was to create a <a href="https://docs.fedoraproject.org/en-US/quick-docs/proc_setting-key-shortcut/" target="_blank">key
shortcut</a>
that triggers this script (which I named <code>tognuterm</code> and turned into an
executable with <code>chmod 755 tognuterm</code>). This works pretty well üéÜ
üî• üí• and not only I can easily run any command from Atom but I also can run a command from any
application (for instance, from my Internet browser üòâ).</p>

<center>
  <video width='
    
      100%
    '
  controls>
    <source src="../../../notes/cli/assets/newshortcut.webm" type="video/webm">
    Your browser does not support the video tag.
  </video>
</center>


<h3 id="important-notes">Important notes</h3>

<h4 id="extra-readings">Extra readings</h4>

<p>First of all, in order to create the script above I&rsquo;ve got good hints reading <a href="https://unix.stackexchange.com/questions/11889/pasting-x-selection-not-clipboard-contents-with-keyboard" target="_blank">this answer on <i class="fa fa-stack-exchange" aria-hidden="true"></i></a>! Second, there is a tool similar to <code>xclip</code>: <a href="https://github.com/kfish/xsel" target="_blank">xsel</a> that you can use here (see below) and  <a href="https://fernandobasso.github.io/shell/copy-paste-from-command-line-xclip-xsel-clipboard.html" target="_blank">Fernando Basso wrote a nice piece about these two</a> that I strongly recommend (obviously, you should also look at the documentation: <code>man xclip</code> and <code>man xdotool</code>). Third, you should better read a bit about <code>xdotool</code> as it is pretty handy: it simulates keyboard input and mouse activity, so you can create script that resize windows, enter keys, <a href="https://www.youtube.com/watch?v=SIjumbdkq_w" target="_blank">clicks</a>, etc. Note that due to its nature, it does interact with your own activity and <a href="https://stackoverflow.com/questions/34092604/xdotool-why-sleep-before-running-commands" target="_blank">that is why using <code>sleep</code> could be useful</a>, it took me some time to understand this but it explains why some time your script does not work!</p>

<h4 id="using-xsel-instead-of-xlip">Using <code>xsel</code> instead of <code>xlip</code></h4>

<p>Here, <code>xsel</code> and <code>xclip</code> are interchangeable, you can use either and even the two of them. If you prefer <code>xsel</code> over <code>xclip</code>, simply replace the line <code>xclip -o -selection primary | xclip -i -selection clipboard</code> by <code>xsel | xsel --clipboard</code>.</p>

<h3 id="only-xdotool-approach">Only <code>xdotool</code> approach</h3>

<p>You can actually simulate a copy event with <code>xdotool</code> instead of using <code>xsel</code> or <code>xclip</code>. I refrained using this approach because ultimately, I would rather opt for a solution that do not require to simulate keyboard events. Anyway, it you want to give it a try, you can replace <code>xclip -o -selection primary | xclip -i -selection clipboard</code> by <code>xdotool key --clearmodifiers ctrl+c</code> and for the reasons explained above you better add a pause before the command (e.g. <code>sleep .2</code>).</p>

<h3 id="using-another-terminal-emulator">Using another Terminal emulator</h3>

<p>The solution should work with any terminal emulator, you simply need to use the
relevant <code>xdotool search</code> command. For instance, if you want to use
<a href="https://gnometerminator.blogspot.com/p/introduction.html" target="_blank">Terminator</a>, the
search command should be <code>xdotool search --class terminator</code>. If you do not know
how to retrieve info about about windows, check <a href="https://linux.die.net/man/1/xwininfo" target="_blank"><code>xwininfo</code></a> out!</p>

<h2 id="concluding-remarks">Concluding remarks</h2>

<ol>
<li><p>The solution I came up with is far from being perfect, but it works well and it is a good starting point. If I improve it in a near future, I&rsquo;ll write another note about this!</p></li>

<li><p>Looks like Wayland is meant to replace X.org, so I&rsquo;d better think about a solution that would work on Wayland&hellip; Again, IMHO, the best approach would not depend on a specific window manager.</p></li>
</ol>

<h2 id="that-s-all-folks">That&rsquo;s all folks!</h2>




    </div>

  </div>

</div>


  <br><br>

  <footer>

    <div class="row">

      <div class="col-sm-3">
        <div class="hidden-sm hidden-xs">
        </div>
      </div>

      <div class="col-sm-8">

        <div class="row">

  <hr>

  <div class="col-sm-10" style="text-align: center">

    Personnal website built with <i class="icon ion-md-heart"></i>, <a href = "https://gohugo.io/">Hugo</a>
    and my <a href = "https://github.com/KevCaz/hugo-KevCaz">own theme</a>!

    <i class="fa fa-code" aria-hidden="true"></i> available on
    <a href = "https://github.com/KevCaz/KevCaz.github.io"><i class="fa fa-github" aria-hidden></i></a>.

    <br>
    All content is licensed under
    <a href='https://creativecommons.org/licenses/by-nc-sa/4.0/'>
       <i class='cc cc-cc-circle cc-1x'></i> <i class='cc cc-by-circle cc-1x'></i>
       <i class='cc cc-nc-circle cc-1x'></i> <i class='cc cc-sa-circle cc-1x'></i>
    </a>
    unless otherwise specified.

  </div>


  <div class="col-sm-2">
    <a href="#"> <i class="fa fa-arrow-circle-o-up fa-2x" aria-hidden="true"></i> </a>
    <br><br>
  </div>


<div>

        

      </div>

    </div>

  <br>
  </footer>

  </body>

</html>

